<%= render partial: 'components/nav_bar', locals: {
  title: 'Create New Game'
} %>

<%= form_for @game, url: games_path, method: :post, local: true do |f| %>
  <h2> Played at: </h2>
  <%= date_field(:game, :played_at, value: Time.zone.now.strftime('%Y-%m-%d')) %>
  <br>
  <h2> State: </h2>
  <%= f.select(:state, options_for_select(%i[completed pending])) %>
  <br>
  <h2> Participating Players: </h2>
  <% @game.game_records.each_with_index do |game_record, index| %>
    <%= f.fields_for :game_record do |game_record_form| %>
    <div style="display:flex;">
    <div id="<%= "player_field_#{index + 1}" %>">
      Player: <%= game_record_form.select(:player, options_for_select(
        @players.collect do |player|
          [player.name, player.id]
        end
      )) %>
    </div>
    <div id="<%= "deck_field_#{index + 1}" %>">
      Deck: <%= game_record_form.select(:deck, options_for_select(
        @decks.collect do |deck|
          [deck.name, deck.id]
        end
      )) %>
    </div>
    <div id="<%= "result_field_#{index + 1}" %>">
      Result: <%= game_record_form.select(:result, options_for_select(%i[loss win draw]), include_blank: true) %>
      <% end %>
    </div>
    </div>
    <% end %>
    <div>
  <br>
  <%= f.submit %>
<% end %>
